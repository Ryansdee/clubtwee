<!DOCTYPE html>
<html lang="nl-NL">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no">
    <title>Menu - CLUB TWEE</title>
    <link rel="shortcut icon" href="./img/favicon.png" type="image/x-icon">
    <meta name="description" content="Club Twee Menu - Broodjes, Focaccia's, Salades en Dranken in Grimbergen">
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.5.2/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=Playfair+Display:wght@400;500;600;700&family=Inter:wght@300;400;500&display=swap" rel="stylesheet">
    
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'menu-bg': '#E5E4E2',
                        'menu-cream': '#f5f0e8',
                        'menu-burgundy': '#580712',
                        'menu-brown': '#3d2314',
                    },
                    fontFamily: {
                        'bebas': ['Bebas Neue', 'cursive'],
                        'playfair': ['Playfair Display', 'serif'],
                        'inter': ['Inter', 'sans-serif'],
                    }
                }
            }
        }
    </script>
    
    <style>
        .font-bebas { font-family: 'Bebas Neue', sans-serif; }
        .font-playfair { font-family: 'Playfair Display', serif; }
        
        .menu-card {
            background: #f5f0e8;
            border: 3px solid #580712;
            border-radius: 8px;
        }
        
        .menu-item {
            display: flex;
            justify-content: space-between;
            align-items: baseline;
            padding: 0.25rem 0;
        }
        
        .menu-item-name {
            font-weight: 600;
            color: #580712;
        }
        
        .menu-item-desc {
            font-size: 0.8rem;
            color: #666;
            font-style: italic;
        }
        
        .menu-item-price {
            font-weight: 700;
            color: #580712;
            white-space: nowrap;
        }
        
        .dotted-line {
            flex: 1;
            border-bottom: 1px dotted #580712;
            margin: 0 8px 4px 8px;
            opacity: 0.4;
        }
        
        .section-title {
            font-family: 'Bebas Neue', sans-serif;
            color: #580712;
            border-bottom: 2px solid #580712;
            padding-bottom: 0.5rem;
            margin-bottom: 1rem;
        }
        
        .loading-spinner {
            border: 3px solid #f5f0e8;
            border-top: 3px solid #580712;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body class="bg-menu-bg min-h-screen">
    <!-- Header -->
    <header class="bg-menu-cream border-b-4 border-menu-burgundy">
        <div class="container mx-auto px-4 py-4 flex justify-between items-center">
            <a href="./index.html" class="flex items-center gap-2">
                <img src="./img/logo.png" alt="Club Twee Logo" class="w-24 md:w-32 h-auto">
            </a>
            <a href="https://www.one2three.app/clubtwee/menu" target="_blank" 
               class="bg-menu-burgundy text-white px-5 py-2 rounded-full font-bebas uppercase text-lg hover:bg-menu-brown transition-colors">
                Bestel Online
            </a>
        </div>
    </header>

    <!-- Main Title -->
    <div class="bg-menu-cream py-8 text-center border-b-4 border-menu-burgundy">
        <h1 class="font-bebas text-5xl md:text-7xl text-menu-burgundy tracking-wide">
            CLUB TWEE<span class="font-playfair italic text-3xl md:text-4xl ml-2">Food & specials</span>
        </h1>
    </div>

    <!-- Loading State -->
    <div id="loading" class="container mx-auto px-4 py-16 text-center">
        <div class="loading-spinner mx-auto mb-4"></div>
        <p class="font-bebas text-xl text-menu-burgundy">Menu wordt geladen...</p>
    </div>

    <!-- Menu Container -->
    <main id="menu-container" class="container mx-auto px-4 py-8 max-w-7xl hidden">
        <!-- Dynamic content will be loaded here -->
    </main>

    <!-- Info Section (static) -->
    <div id="info-section" class="container mx-auto px-4 pb-8 max-w-7xl hidden">
        <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
            <!-- Sweet Treats & Info -->
            <div class="menu-card p-6 text-center">
                <h2 class="font-bebas text-3xl text-menu-burgundy mb-4">SWEET TREATS</h2>
                <p class="text-gray-600 mb-6">Check de toonbank voor ons assortiment!</p>
                
                <div class="border-t-2 border-b-2 border-menu-burgundy border-opacity-30 py-4 my-4">
                    <p class="font-bebas text-xl text-menu-burgundy">KEUKEN SLUIT OM 15:00</p>
                </div>
                
                <p class="text-sm text-gray-600 mb-4">
                    Vermijd de broodjesfile: plaats je bestelling online voor 11u en haal je broodje zonder stress en zonder wachten op.
                </p>
                <p class="font-semibold text-menu-burgundy mb-4">www.clubtwee.be</p>
                <p class="text-sm text-gray-600">Volg ons op Instagram!</p>
            </div>
            
            <!-- WiFi & Info -->
            <div class="menu-card p-6 text-center flex flex-col justify-center">
                <div class="mb-6">
                    <p class="text-lg"><strong>WIFI:</strong> CLUBTWEE</p>
                    <p class="text-lg"><strong>WACHTWOORD:</strong> CLUBTWEEOLE!</p>
                </div>
                <p class="font-bebas text-2xl text-menu-burgundy">BESTELLEN AAN DE BAR</p>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="bg-menu-burgundy text-white py-8">
        <div class="container mx-auto px-4 text-center">
            <img src="./img/logo.png" alt="Club Twee Logo" class="w-20 mx-auto mb-4 brightness-0 invert">
            <p class="font-bebas text-2xl mb-2">CLUB TWEE</p>
            <p class="text-sm opacity-80 mb-4">Beigemsesteenweg 2, 1850 Grimbergen</p>
            <div class="flex justify-center gap-6 mb-4">
                <a href="https://www.instagram.com/clubtwee/" target="_blank" class="hover:text-amber-400 transition-colors">
                    <i class="fab fa-instagram text-2xl"></i>
                </a>
                <a href="tel:+022709546" class="hover:text-green-400 transition-colors">
                    <i class="fas fa-phone text-2xl"></i>
                </a>
            </div>
            <p class="text-sm opacity-60">Â© 2025 Club Twee - Your happy place</p>
        </div>
    </footer>

    <!-- Firebase SDK -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
        import { getFirestore, collection, getDocs } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";

        // Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyAqmesvJgvRnZHm1777niBFRBjj0P_SBT0",
            authDomain: "clubtwee-menu.firebaseapp.com",
            projectId: "clubtwee-menu",
            storageBucket: "clubtwee-menu.firebasestorage.app",
            messagingSenderId: "852997452508",
            appId: "1:852997452508:web:763f2e7f820b5509da3a19"
        };

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);

        // Category display order (customize as needed)
        const categoryOrder = [
            'Basics',
            'Specials', 
            'Focaccias',
            "Focaccia's",
            'Salades',
            'Food Specials',
            'Pick & Plate',
            'Yoghurt Bowl',
            'Koffie',
            'Iets Anders',
            'Thee',
            'Fris',
            'Bier',
            'Cocktails',
            'Wijnen'
        ];

        // Food categories (for layout purposes)
        const foodCategories = ['Basics', 'Specials', 'Focaccias', "Focaccia's", 'Salades', 'Food Specials', 'Pick & Plate', 'Yoghurt Bowl'];
        const drinkCategories = ['Koffie', 'Iets Anders', 'Thee', 'Fris', 'Bier', 'Cocktails', 'Wijnen'];

        // Format price
        function formatPrice(price) {
            return parseFloat(price).toFixed(2).replace('.', ',');
        }

        // Create menu item HTML
        function createMenuItem(name, data) {
            const hasDescription = data.description && data.description.trim() !== '';
            
            return `
                <div class="mb-2">
                    <div class="menu-item">
                        <span class="menu-item-name">${name}</span>
                        <span class="dotted-line"></span>
                        <span class="menu-item-price">${formatPrice(data.price)}</span>
                    </div>
                    ${hasDescription ? `<p class="menu-item-desc">${data.description}</p>` : ''}
                </div>
            `;
        }

        // Create category card HTML
        function createCategoryCard(categoryName, items) {
            const itemsHTML = items.map(item => createMenuItem(item.name, item.data)).join('');
            const isPickAndPlate = categoryName.toLowerCase() === 'pick & plate';
            const borderStyle = isPickAndPlate ? 'border-style: dashed;' : '';
            
            return `
                <div class="menu-card p-6" style="${borderStyle}">
                    <h2 class="section-title text-2xl md:text-3xl">${categoryName.toUpperCase()}</h2>
                    <div class="space-y-1">
                        ${itemsHTML}
                    </div>
                </div>
            `;
        }

        // Check if category is food or drink
        function isFoodCategory(cat) {
            return foodCategories.some(fc => fc.toLowerCase() === cat.toLowerCase());
        }
        
        function isDrinkCategory(cat) {
            return drinkCategories.some(dc => dc.toLowerCase() === cat.toLowerCase());
        }

        // Load menu from Firebase
        async function loadMenu() {
            try {
                const menuContainer = document.getElementById('menu-container');
                const loading = document.getElementById('loading');
                const infoSection = document.getElementById('info-section');
                
                // Get all categories
                const categoriesSnap = await getDocs(collection(db, 'menus'));
                const categories = {};
                
                // Load items for each category
                for (const catDoc of categoriesSnap.docs) {
                    const catName = catDoc.id;
                    const itemsSnap = await getDocs(collection(db, `menus/${catName}/items`));
                    
                    if (!itemsSnap.empty) {
                        categories[catName] = [];
                        itemsSnap.forEach(itemDoc => {
                            categories[catName].push({
                                name: itemDoc.id,
                                data: itemDoc.data()
                            });
                        });
                        
                        // Sort items by name
                        categories[catName].sort((a, b) => a.name.localeCompare(b.name));
                    }
                }

                // Sort categories according to order
                const sortedCategories = Object.keys(categories).sort((a, b) => {
                    const indexA = categoryOrder.findIndex(c => c.toLowerCase() === a.toLowerCase());
                    const indexB = categoryOrder.findIndex(c => c.toLowerCase() === b.toLowerCase());
                    if (indexA === -1 && indexB === -1) return a.localeCompare(b);
                    if (indexA === -1) return 1;
                    if (indexB === -1) return -1;
                    return indexA - indexB;
                });

                // Separate food and drinks
                const foodCats = sortedCategories.filter(cat => isFoodCategory(cat));
                const drinkCats = sortedCategories.filter(cat => isDrinkCategory(cat));
                const otherCats = sortedCategories.filter(cat => !isFoodCategory(cat) && !isDrinkCategory(cat));

                // Build HTML
                let html = '';

                // Food Section
                const allFoodCats = [...foodCats, ...otherCats];
                if (allFoodCats.length > 0) {
                    html += `<div class="grid grid-cols-1 lg:grid-cols-2 gap-8 mb-12">`;
                    
                    // Left column (even indices)
                    html += `<div class="space-y-8">`;
                    allFoodCats.forEach((cat, i) => {
                        if (i % 2 === 0) {
                            html += createCategoryCard(cat, categories[cat]);
                        }
                    });
                    html += `</div>`;
                    
                    // Right column (odd indices)
                    html += `<div class="space-y-8">`;
                    allFoodCats.forEach((cat, i) => {
                        if (i % 2 === 1) {
                            html += createCategoryCard(cat, categories[cat]);
                        }
                    });
                    html += `</div>`;
                    
                    html += `</div>`;
                }

                // Drinks Section
                if (drinkCats.length > 0) {
                    html += `
                        <div class="mb-8">
                            <div class="bg-menu-cream py-6 text-center border-y-4 border-menu-burgundy mb-8">
                                <h1 class="font-bebas text-4xl md:text-6xl text-menu-burgundy tracking-wide">
                                    CLUB TWEE<span class="font-playfair italic text-2xl md:text-3xl ml-2">Drinks</span>
                                </h1>
                            </div>
                            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
                    `;
                    
                    drinkCats.forEach(cat => {
                        html += createCategoryCard(cat, categories[cat]);
                    });
                    
                    html += `</div></div>`;
                }

                // Check if we have any content
                if (Object.keys(categories).length === 0) {
                    html = `
                        <div class="text-center py-16">
                            <i class="fas fa-utensils text-6xl text-menu-burgundy opacity-30 mb-4"></i>
                            <p class="font-bebas text-2xl text-menu-burgundy">Geen menu items gevonden</p>
                            <p class="text-gray-600">Het menu wordt binnenkort bijgewerkt.</p>
                        </div>
                    `;
                }

                // Update DOM
                menuContainer.innerHTML = html;
                
                // Hide loading, show content
                loading.classList.add('hidden');
                menuContainer.classList.remove('hidden');
                infoSection.classList.remove('hidden');

            } catch (error) {
                console.error('Error loading menu:', error);
                document.getElementById('loading').innerHTML = `
                    <div class="text-center">
                        <i class="fas fa-exclamation-triangle text-4xl text-menu-burgundy mb-4"></i>
                        <p class="font-bebas text-xl text-menu-burgundy">Fout bij het laden van het menu</p>
                        <p class="text-gray-600 mt-2">Probeer de pagina te vernieuwen</p>
                        <button onclick="location.reload()" class="mt-4 bg-menu-burgundy text-white px-6 py-2 rounded-full font-bebas">
                            Opnieuw proberen
                        </button>
                    </div>
                `;
            }
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', loadMenu);
    </script>
</body>
</html>